{% extends 'base.html' %}
{% block content %}

<div class="card border-white">
    <div class="card-body">
      <h1 style="text-align: center;">Rendición de Gastos</h1>
    </div>
  </div>
    
<br>
      <div class="card border-white">
        <div class="card-body">


            <form class="row g-3" id="agrega_gastos" method="POST">
                <div class="col-md-6">
                  <label for="fecha_gasto" class="form-label">Fecha</label>
                  <input type="date" class="form-control" id="fecha_rendicion" name="fecha_rendicion">
                </div>
                <div class="col-md-6">
                  <label for="tipo_gasto" class="form-label">Tipo de Gasto</label>
                  <input type="text" class="form-control" id="tipo_gasto" name="tipo_gasto">
                </div>
                <div class="col-12">
                  <label for="descripcion_gasto" class="form-label">Descripción</label>
                  <input type="text" class="form-control" id="descripcion" name="descripcion">
                </div>
                <div class="col-12">
                  <label for="empleado_gasto" class="form-label">Empleado</label>
                  <select id="empleado" name="empleado" class="form-control">
                    <option selected disabled>Seleccione</option>
                    {%for emp in users%}
                    
                    <option value="{{emp.id}}">{{emp.nombre}}</option>
                    
                    {%endfor%}
                  </select>
                </div>
                <div class="col-md-12">
                  <label for="monto_gasto" class="form-label">Monto</label>
                  <input type="number" class="form-control" id="monto_gasto" name="monto_gasto">
                </div>
                <div class="col-md-12">
                    <label for="agregar_comprobante" class="form-label">Comprobante</label>
                    <input type="file" id="archivo" name="archivo">                    
                </div>

                <div class="col-12">
                  <button type="submit" class="btn btn-primary">Guardar</button>
                </div>
              </form>

      </div>
    </div>
    <br>
    <div class="card border-white">
      <div class="card-body">
        <form class="row g-3">
            <div class="col-md-6">
              <label for="fehca_inicio_busqueda" class="form-label">Fecha inicio</label>
              <input type="date" class="form-control" id="fehca_inicio_busqueda">
            </div>
            <div class="col-md-6">
              <label for="fecha_fin_busqueda" class="form-label">Fecha Fin</label>
              <input type="date" class="form-control" id="fecha_fin_busqueda">
            </div>
        </form>
  
      </div>
  </div>    
  <br>
  <div class="card border-white">
    <div class="card-body">
        <table class="table">
            <thead>
              <tr>
                <th>Fecha</th>
                <th>Tipo de Gasto</th>
                <th>Descripción</th>
                <th>Empleado</th>
                <th>Monto</th>
                <th></th>
              </tr>
            </thead>
            <tbody>
              {% for dato in gastos %}
              <tr>
                <th scope="row">{{dato.fecha_rendicion}}</th>
                <th scope="row">{{dato.tipo_gasto}}</th>
                <th scope="row">{{dato.descripcion}}</th>
                <th scope="row">{{dato.empleado}}</th>
                <th scope="row">{{dato.monto_gasto}}</th>
                <td>
                    <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
                        ver
                      </button>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
    </div>
</div>    


<div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="staticBackdropLabel">Detalle Gasto</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
            <div class="card border-white" style="padding-top: 50px; padding-bottom: 50px; margin-left: 25px; margin-right: 25px;">
                <div class="container text-center">
                    <div class="row align-items-start">
                      <div class="col">
                      </div>
                      <div class="col">
                      </div>
                      <div class="col">
                        <img src="{{url_for('static', filename='./img/logo-ct.png')}}" alt="" >
                    </div>
                    </div>
                  </div>
            
                  <div class="container text-center">
                    <div class="row align-items-start">
                      <div class="col">
                      </div>
                      <div class="col">
                        <h5>Rendición de Gastos</h5>
                        <p>Mes [indicar mes]</p>
                      </div>
                      <div class="col">
                    </div>
                    </div>
                  </div>
             <br>
            
                  <div class="container text-left">
                    <div>
                        <p>Nombre: [Nombre]
                           <br> Fecha de Rendición: [fecha]</p>
                      </div>
                  </div>
                  <br>
                 
                    <div class="container">
                        <table class="table table-bordered">
                          <tdead>
                            <tr>
                              <th>Fecha</th>
                              <th>Tipo de Gasto</th>
                              <th>Descripción</th>
                              <th>Empleado</th>
                              <th>Monto</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr>
                              <td></td>
                              <td></td>
                              <td></td>
                              <td></td>
                              <td></td>
                            </tr>
                            <tr>
                              <th colspan="3 border"></th>
                              <th class="table-active">Total:</th>
                              <th class="table-active">$ [suma]</th>
                          </tr>
                          </tbody>
                        </table>
                    </div>
            
                    <br><br><br>
              
            
                    <div class="container text-center">
                        <div class="row align-items-start">
                            <div class="col">
                                <h3>Carolina Lara</h3>
                                <p>V°B° Controller</p>
                            </div>
                            <div class="col">                            
                            </div>
                            <div class="col">
                                Firma Empleado
                            </div>
                        </div>
                    </div>

                      <center>Santiago, [Fecha]</center>
                      
            </div>
        </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-primary">Imprimir</button>
            </div>
      </div>
    </div>
  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>

  <script>
    const generarPDF = () => {
      const element = document.querySelector(".card");
      const options = {
        margin: 0,
        filename: "Rendicion_gastos[numero].pdf",
        image: { type: "jpeg", quality: 1 },
        html2canvas: { scale: 2 },
        jsPDF: { unit: "in", format: "letter", orientation: "portrait" },
      };
  
      html2pdf()
        .from(element)
        .set(options)
        .save();
    };
  
    document.querySelector("#generar-pdf").addEventListener("click", generarPDF);
  
  </script>
<script src="{{ url_for('static', filename='js/otro.js')}}"></script>
{% endblock %}